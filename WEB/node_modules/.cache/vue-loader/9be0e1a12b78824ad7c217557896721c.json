{"remainingRequest":"D:\\Projects\\Project_QLQ_DHXSKD\\WEB\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Projects\\Project_QLQ_DHXSKD\\WEB\\src\\views\\Rasoat_thuebao.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\Projects\\Project_QLQ_DHXSKD\\WEB\\src\\views\\Rasoat_thuebao.vue","mtime":1606729964840},{"path":"D:\\Projects\\Project_QLQ_DHXSKD\\WEB\\node_modules\\css-loader\\dist\\cjs.js","mtime":1606729951351},{"path":"D:\\Projects\\Project_QLQ_DHXSKD\\WEB\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1606729962144},{"path":"D:\\Projects\\Project_QLQ_DHXSKD\\WEB\\node_modules\\postcss-loader\\src\\index.js","mtime":1606729957250},{"path":"D:\\Projects\\Project_QLQ_DHXSKD\\WEB\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1606729949731},{"path":"D:\\Projects\\Project_QLQ_DHXSKD\\WEB\\node_modules\\vue-loader\\lib\\index.js","mtime":1606729962144}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLnYtdGV4dC1maWVsZCB7DQogIHBhZGRpbmctdG9wOiAwcHg7DQogIG1hcmdpbi10b3A6IDBweDsNCn0NCi52LWRhdGEtdGFibGUgPiAudi1kYXRhLXRhYmxlX193cmFwcGVyID4gdGFibGUgPiB0aGVhZCA+IHRyID4gdGh7DQogIGZvbnQtc2l6ZTogMXJlbTsNCiAgaGVpZ2h0OiAzNXB4Ow0KfQ0K"},{"version":3,"sources":["Rasoat_thuebao.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Rasoat_thuebao.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    \r\n      <v-row>\r\n        <v-col>\r\n          <v-card class=\"mx-auto\" color=\"\" light>\r\n            <v-card-title class=\"info--text\">\r\n              <v-icon large left color=\"info\">\r\n              mdi-book-search-outline </v-icon\r\n              >Rà soát thuê bao không ghép được cước\r\n              <v-spacer></v-spacer>\r\n              \r\n            </v-card-title>\r\n          </v-card>\r\n\r\n        </v-col>\r\n      </v-row>\r\n      <v-row>\r\n        <v-col cols=\"1\">\r\n        </v-col>\r\n        <v-col cols=\"10\" >\r\n        \r\n          <template >\r\n            <v-card style=\"min-height: 490px;\">\r\n              <v-card-title>\r\n                Danh sách thuê bao không ghép được cước\r\n               <v-file-input style=\"padding:0px 50px;\"\r\n                label=\"Tải lên danh sách thuê bao\"\r\n                @change=\"selectFile\"\r\n                accept=\".xlsx, .xls\"\r\n                prepend-icon=\"mdi-file-excel\"\r\n                truncate-length=\"15\"\r\n                ></v-file-input>\r\n    \r\n                <v-btn\r\n                color=\"primary\"\r\n                elevation=\"2\"\r\n                medium\r\n                >Xuất ra Excel</v-btn>\r\n              </v-card-title>\r\n              <v-data-table\r\n                :headers=\"headers_tb\"\r\n                :items=\"items_tb\"\r\n                :search=\"search\"\r\n                :items-per-page=\"5\"\r\n                @click:row=\"handleClick\"\r\n              ></v-data-table>\r\n            </v-card>\r\n          </template>\r\n              \r\n        </v-col>\r\n        <v-col cols=\"1\">\r\n        </v-col>\r\n\r\n       \r\n      </v-row>\r\n    \r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data(){\r\n    return{\r\n      search: \"\",\r\n      progress: \"\",\r\n      currentFile:\"\",\r\n      headers_tb: [\r\n          { text: '', value: 'stt'},\r\n          { text: 'ID thuê bao', value: 'thuebao_id' },\r\n          { text: 'Tên thuê bao', value: 'ten_tb' },\r\n          { text: 'Dịch vụ', value: 'dichvu' },\r\n          { text: 'Ngày cập nhật', value: 'ngay_cn' },\r\n          { text: 'Ngày thêm vào', value: 'ngay_ins' },\r\n        ],\r\n      items_tb:[\r\n            {stt:\"1\",thuebao_id:\"2707242\",ten_tb:\"NGUYEN DUY ANH\",dichvu:\"Fiber\",ngay_cn:\"05-MAY-15\",ngay_ins:\"05-MAY-15\"},\r\n            {stt:\"2\",thuebao_id:\"2872892\",ten_tb:\"NGUYEN VAN DUC\",dichvu:\"Fiber\",ngay_cn:\"\",ngay_ins:\"05-MAY-15\"},\r\n            {stt:\"3\",thuebao_id:\"2712925\",ten_tb:\"NGUYEN THI TY\",dichvu:\"Fiber\",ngay_cn:\"05-MAY-15\",ngay_ins:\"05-MAY-15\"},\r\n            {stt:\"4\",thuebao_id:\"2712111\",ten_tb:\"NGUYEN THI KIM CHUNG\",dichvu:\"Fiber\",ngay_cn:\"05-MAY-15\",ngay_ins:\"05-MAY-15\"},\r\n            {stt:\"5\",thuebao_id:\"2896051\",ten_tb:\"PHAM THI HIEU NHI\",dichvu:\"Fiber\",ngay_cn:\"05-MAY-15\",ngay_ins:\"05-MAY-15\"},\r\n            {stt:\"6\",thuebao_id:\"2894590\",ten_tb:\"PHUNG THI CAM CAT\",dichvu:\"Fiber\",ngay_cn:\"05-MAY-15\",ngay_ins:\"05-MAY-15\"},\r\n            {stt:\"7\",thuebao_id:\"2897095\",ten_tb:\"DUONG VAN BINH\",dichvu:\"Fiber\",ngay_cn:\"05-MAY-15\",ngay_ins:\"05-MAY-15\"},\r\n            {stt:\"8\",thuebao_id:\"2712010\",ten_tb:\"TRAN THI HONG DIEP\",dichvu:\"Fiber\",ngay_cn:\"05-MAY-15\",ngay_ins:\"05-MAY-15\"},\r\n            {stt:\"9\",thuebao_id:\"2890227\",ten_tb:\"LY NGUYEN TICH\",dichvu:\"Fiber\",ngay_cn:\"05-MAY-15\",ngay_ins:\"05-MAY-15\"},\r\n            {stt:\"10\",thuebao_id:\"2891885\",ten_tb:\"NGUYEN BA HIEN\",dichvu:\"Fiber\",ngay_cn:\"05-MAY-15\",ngay_ins:\"05-MAY-15\"}        \r\n      ],\r\n      \r\n    }\r\n  },\r\n  methods:{\r\n    handleClick(e){\r\n      console.log(e.ma_vn);\r\n      this.headers_menu[0].text = 'Menu chức năng của người dùng ' + e.ten_nv;\r\n\r\n    },\r\n    selectFile(file) {\r\n      var self=this;\r\n        if(file){\r\n            if((file.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') \r\n                || (file.type == 'application/vnd.ms-excel')){\r\n                self.import_data_from_excel();\r\n            } else {\r\n                self.$message({\r\n                    type:'warning',\r\n                    message:'File không đúng định dạng'\r\n                })\r\n            }\r\n        } \r\n    },\r\n\r\n    import_data_from_excel() {\r\n          let self = this;\r\n          let inputDOM = self.$refs.inputer;\r\n          // Retrieving file data through DOM\r\n\r\n          self.file = event.currentTarget.files[0];\r\n\r\n          var rABS = false; //Read the file as a binary string\r\n          var f = self.file;\r\n\r\n          var reader = new FileReader();\r\n          //if (!FileReader.prototype.readAsBinaryString) {\r\n          FileReader.prototype.readAsBinaryString = function(f) {\r\n              var binary = \"\";\r\n              var rABS = false; //Read the file as a binary string\r\n              var pt = self;\r\n              var wb; //Read completed data\r\n              var outdata;\r\n              var reader = new FileReader();\r\n              reader.onload = function(e) {\r\n                  var bytes = new Uint8Array(reader.result);\r\n                  var length = bytes.byteLength;\r\n                  for (var i = 0; i < length; i++) {\r\n                      binary += String.fromCharCode(bytes[i]);\r\n                  }\r\n                  //If not introduced in main.js, you need to introduce it here to parse excel\r\n                  var XLSX = require(\"xlsx\");\r\n                  if (rABS) {\r\n                      wb = XLSX.read(btoa(fixdata(binary)), {\r\n                      //Manual conversion\r\n                      type: \"base64\"\r\n                      });\r\n                  } else {\r\n                      wb = XLSX.read(binary, {\r\n                      type: \"binary\"\r\n                      });\r\n                  }\r\n                  outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]); \r\n                  if(\"MA_TB\" in outdata[0])\r\n                  {\r\n                    var arr_ma_tb=[];\r\n                    outdata.forEach(function(element,key){\r\n                      arr_ma_tb.push(\r\n                        element.MA_TB\r\n                      )\r\n                    });\r\n                    console.log(arr_ma_tb);\r\n                  }else\r\n                  {\r\n                    self.$message({\r\n                    type:'warning',\r\n                    message:\"File vừa tải lên không có dữ liệu 'MA_TB'\"\r\n                })\r\n                  }\r\n              };\r\n              reader.readAsArrayBuffer(f);\r\n          };\r\n          if (rABS) {\r\n              reader.readAsArrayBuffer(f);\r\n          } else {\r\n              reader.readAsBinaryString(f);\r\n          }\r\n      }\r\n\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style>\r\n.v-text-field {\r\n  padding-top: 0px;\r\n  margin-top: 0px;\r\n}\r\n.v-data-table > .v-data-table__wrapper > table > thead > tr > th{\r\n  font-size: 1rem;\r\n  height: 35px;\r\n}\r\n</style>"]}]}